#!/bin/bash

bearertoken=`./userAuth "$1" "$2" | grep 'bearerToken' | cut -f2 -d " "`
echo $bearertoken

#url="https://identity.webex.com/idb/oauth2/tokeninfo"
url="https://idbroker.webex.com/idb/oauth2/v1/tokeninfo"

start=$(date +%s)
echo $start

header="Content-type:application/x-www-form-urlencoded"
header2="Accept: application/json"
#header3="Host: identity.webex.com"
header3="Host: idbroker.webex.com"

#data='access_token=eyJhbGciOiJSUzI1NiJ9.eyJwcml2YXRlIjoiZXlKamRIa2lPaUpLVjFRaUxDSmxibU1pT2lKQk1USTRRMEpETFVoVE1qVTJJaXdpWVd4bklqb2laR2x5SW4wLi5MUFF5WDhNY1J6ODBzLTdHejBmQlRnLmpKTEctZ3BrcmkwWDlHUHlzdzVyai1lcmtGSlhjVGQ3VktVZ3Y4V2RkMFprYmh1RUFGeVN6WWZIcEFQakVRZkN2YU4wM2NKUG41SjRUakUxTk90c2JzWkU5bWpJWU5CcElRLVVVSVFnOG50aWlHRFh0ek9sQXdSdnMybVV6RTFuWE9pRUNNUlg3OC1LdkQwYlpsY3cwdjBDUGRadS1faU1MOVREeF9SaENHYmR0dmJwTkRCQUpzM2k2S2FhbGxoei05RGpzRndjOTZ0RlhwZVpXS2lIbW1pVTF4Zkc4WVpITFdUeUNSUHJOb1p6VGRuN0d4YlBYS0FycUNBMXZyN2ZSZUZ1ZDBwTExqYTVOTTdDZllZTHZUdllkVnZyLVRmV3dUa3Q5UnBFWXBUdExYWFR4eVRidXp3bHFfZ1ZaRkFFbE1KbzdCdlVTdzNNRktJczRQck5uMmRMc2VLWHF2UTNia1gxQURHYVk3VWVCYWVHSm40VUVfUW12QTllaUd1YVJSM2NfV3h6UWR6QjMtd2QxVjR4QW5Bc2l4UFRBaXVqc3lLZDJxT2NZSVhJZVp3WUhjUFRRQWRDOWtZN0xFRGk3YlNWMDZHN29mRWlNU0VjX09KV2RuY3NabHBtQWloaEl0N1VqTkhOeXN1TU1DSndkQmRzQnpmLXd6eXJxUVhNdFR3cFA0WEIwMnBfeHd6bk5IYW5lUG04MS1jbWQydEVMRGMtX1BPOThEWDFjcl9nc3g3cWoxSzkyVzJfaGc2OGZxQkhRbEZFYVpZTG1xNGYzS3lFb0NCQmFiblpodVRyY3VPSTA0N3A4blYxSWRvZjVJR0VYSjVqYVFXcUJwSXg2eXpUNTI5dU9wYkJyTy1XeW1Ja0FZa1c3VmE4ZVg0ZHFYRUlCdFZJeUE0MDN6YWZqQlBORnc1elEyVWE3MVcxLjFSRlJja1pVVE51MkU0QzBRWnhlX3ciLCJ1c2VyX3R5cGUiOiJzZXJ2aWNlIiwidG9rZW5faWQiOiJBYVozcjBZMkpqTkdGbFpURXRNRE00WmkwME5XTmhMVGhqTVdVdE1UazVOelpqWVRsbVl6a3dPVGMzTURBNU9XVXRNVEk0IiwicmVmZXJlbmNlX2lkIjoiMTE1NWMwNTItOWI4OS00NDQzLWIyZDgtZDk1MjU3ZGYzNzk5IiwiaXNzIjoiaHR0cHM6XC9cL2lkYnJva2VyLndlYmV4LmNvbVwvaWRiIiwidXNlcl9tb2RpZnlfdGltZXN0YW1wIjoiMjAxODA0MTYxNjE5MjEuODM2WiIsInJlYWxtIjoiY29tbW9uX2lkZW50aXR5X29wZXJhdGlvbnMiLCJjaXNfdXVpZCI6IjkyMDMwNTA3LTc0ZGQtNDI3My1iM2Y3LWNiMzAxN2NjM2M3NiIsInRva2VuX3R5cGUiOiJCZWFyZXIiLCJleHBpcnlfdGltZSI6MTUzNjYxMjU4MTIzNiwiY2xpZW50X2lkIjoiQ2IwNjBmYjQyNWFiOGYwZTgzMTAxMzZlMWVhZGQyNjJjZDc2MjA1OTkwZTQzOTM3YzQxYTA1ZDI4Y2ZjMDRkYWIifQ.DqHlqtlwaKs6-dKw_0obHfbQLF9obPQ150OdJkkwfzCXEPpohnsEtcBSgvFj5CrF_fwSxEDi4jvQw2Vi4dHevDy9ikozFBmLyEmQjD4sf0TPEBJb_BHnPZdWMTgVIPI-mG8KdxsMo50Kg9pCQc98QXf-qfkOxt_cEHxjx9IcZvWNZBarBK7LGRCmg4OieLS0ydZHBD_scX6W3rMOi2SgiBb_IaTJdag09NhvkNT_SoaSXsGYOhY-iHCvq13hREmCgFayWltLRcehPrAiroMHX9ZIGxGlrMlQ73U9Dvkz-97A0ufbyJo1y_RLPXH4odVnJFblh_iYGS21a-6eRXP4SA'
data='access_token=eyJhbGciOiJSUzI1NiJ9.eyJwcml2YXRlIjoiZXlKamRIa2lPaUpLVjFRaUxDSmxibU1pT2lKQk1USTRRMEpETFVoVE1qVTJJaXdpWVd4bklqb2laR2x5SW4wLi5qNzJWVmtobFZDdzhUOUtLNkFCWDhRLmYtdWVCRXNqN2hkVG1kU1ZvNGdLVFNyaXY0REwwLV9BdTNnWkRWaHV6QThVY25ZSGlCelZkSmV6Q2hCbXpRRlhWRnV4QzJpYUpYcUNrdUt1RzJWRGJLbjRJZklWYy1Gdkt5ZWREVjFmMmUzVWwwVURrbVZQZ2ducmIzNDVkTHp2dlhrNTRxYkpqWlAxV0hXWklKbUZWWEdsYW1GWUZwNXhSc1lBR19Fb3FoVXNHX3B4bnZjX3pEaEhidUVpVzZoMzI5eFB5c0MzNFVqWC16N2JLZzNaLTduZ3RqVVA3aU0tU2pzMUN0SE00VW56dkxpVTVkSWptVWZZTF9BTWNLcVcyc1hzYmJHd1Z2RnFQUjlHVUhPMVVPWUx4XzdtRUZjYVQ1VWh6NTFNZUVyMjdobEM3VDFsX296dHpYNVhYd3FYLkNuNHh2cVRTbElQbEwzZTR5TXlWVlEiLCJ1c2VyX3R5cGUiOiJ1c2VyIiwidG9rZW5faWQiOiJBYVozcjBZekEzWkdFNVkyVXRObVZtWVMwME9Ea3hMV0UyWlRrdE9HSXlORE0yTUROalpUa3lOVE14WlRSbVlURXRZVFJpIiwiaXNzIjoiaHR0cHM6XC9cL2lkYnJva2VyLndlYmV4LmNvbVwvaWRiIiwidXNlcl9tb2RpZnlfdGltZXN0YW1wIjoiMjAxODA5MDEwMjIxMDAuNjYxWiIsInJlYWxtIjoiZTYyMTZjZTktNWFiMy00OWNkLThjNDYtY2Q1ZThhZTBmYmI0IiwiY2lzX3V1aWQiOiI0YTExYTE1MC05NjdlLTQ2YzQtOWUzYS02YTY5MDU3ZWI2NmIiLCJ0b2tlbl90eXBlIjoiQmVhcmVyIiwiZXhwaXJ5X3RpbWUiOjE1MzY2NDA4OTUxMzcsImNsaWVudF9pZCI6IkNiMTEwZmZkYTdhMjFkM2I0MTc2MTM2YzRlNzA3MTI2YzllMThjNGVmNGMzZGFmYjJhOTdhYjAyMmJjMDBhOTZhIn0.P9UkZ1mIjwCe0ofGXlXQIt5zpxocLHJmgozQtjOIO2vynvn4-cU_MkU7ADaq3TQsRBDFBVmcJuzWtmA6sFrEqXna_FgTCOxNT7uVCUj1UORFS8TDywzVFXQ4wENJ7CkaOqiCIYqiVWQz4biGMxIMxE0qhsaalhupIrnMg41qrYEsDQdxNebYtiEaWQdFh7AgRFRXQyHHFf5CtT-ObJvHKx2q1g3DZQdv3TBWMHHpHVoDHE-vTDJgNWXwARpEauozc5NfBAyLUYyfQrVyOZnlDknJNx2vgcJ1E8wwJFivsmOCBMNLppSKt7vyYAy9yT6k8tn947W3eBtOQnqCpECKTw'
#data='access_token='$bearertoken''
echo $data
curl -vvv -k  -H "$header" -H "$header2" -H "$header3" --data "$data" --user "Rd5f57d6b41e7185845025293cb0009787c0a8f6472e3e7f4994457066ebd8c9e":"b3a189c80afc705486eda9353d20a2ec5c9deff13cce7eb185e6f71875c3f447" $url | python -mjson.tool
